#!/bin/bash

# Basic SketchyBar configuration
# Colors: Catppuccin Macchiato (matching tmux)

# Bar appearance
sketchybar --bar height=32 \
                 blur_radius=30 \
                 position=top \
                 sticky=off \
                 padding_left=10 \
                 padding_right=10 \
                 color=0xcc24273a \
                 shadow=on

# Default item settings (shared defaults for all plugins)
sketchybar --default icon.font="FiraCode Nerd Font Mono:Bold:15.0" \
                     icon.color=0xffcad3f5 \
                     label.font="FiraCode Nerd Font Mono:Bold:13.0" \
                     label.color=0xffa6da95 \
                     padding_left=5 \
                     padding_right=5 \
                     label.padding_left=4 \
                     label.padding_right=4 \
                     icon.padding_left=4 \
                     icon.padding_right=4

# Left side - hostname with rounded background
sketchybar --add item hostname left \
           --set hostname update_freq=0 \
                         icon.drawing=off \
                         label.font="FiraCode Nerd Font Mono:Bold:13.0" \
                         label.color=0xff91d7e3 \
                         label.padding_left=10 \
                         label.padding_right=10 \
                         background.color=0xff363a4f \
                         background.corner_radius=6 \
                         background.height=24 \
                         background.drawing=on \
                         padding_left=5 \
                         padding_right=0 \
                         script="$HOME/.config/sketchybar/plugins/hostname.sh"

# Left side - active window title (before workspaces) with rounded background
# sketchybar --add item window_title left \
#            --set window_title update_freq=2 \
#                               icon.drawing=off \
#                               label.font="FiraCode Nerd Font Mono:Bold:13.0" \
#                               label.color=0xff91d7e3 \
#                               label.padding_left=10 \
#                               label.padding_right=10 \
#                               background.color=0xff363a4f \
#                               background.corner_radius=6 \
#                               background.height=24 \
#                               background.drawing=on \
#                               padding_left=5 \
#                               padding_right=0 \
#                               script="$HOME/.config/sketchybar/plugins/window_title.sh" \
#            --subscribe window_title aerospace_workspace_change

# Left side - workspaces (dynamic - only show workspaces with windows)
# Create placeholder items for potential workspaces
for i in {1..9}; do
  sketchybar --add item space.$i left \
             --set space.$i icon="$i" \
                            icon.font="SF Mono:Bold:14.0" \
                            icon.color=0xffcad3f5 \
                            label.drawing=off \
                            padding_left=0 \
                            padding_right=0 \
                            icon.padding_left=0 \
                            icon.padding_right=0 \
                            background.padding_left=5 \
                            background.padding_right=5 \
                            background.color=0xff363a4f \
                            background.corner_radius=6 \
                            background.height=26 \
                            background.border_width=2 \
                            background.border_color=0xff24273a \
                            background.drawing=on \
                            width=30 \
                            icon.width=30 \
                            icon.align=center \
                            drawing=off \
                            click_script="aerospace workspace $i"
done

# Add named workspaces (like S for Slack)
sketchybar --add item space.S left \
           --set space.S icon="S" \
                         icon.font="SF Mono:Bold:14.0" \
                         icon.color=0xffcad3f5 \
                         label.drawing=off \
                         padding_left=0 \
                         padding_right=0 \
                         icon.padding_left=0 \
                         icon.padding_right=0 \
                         background.padding_left=5 \
                         background.padding_right=5 \
                         background.color=0xff363a4f \
                         background.corner_radius=6 \
                         background.height=26 \
                         background.border_width=2 \
                         background.border_color=0xff24273a \
                         background.drawing=on \
                         width=30 \
                         icon.width=30 \
                         icon.align=center \
                         drawing=off \
                         click_script="aerospace workspace S"

# Add X workspace (Xtra/Last workspace - alt-0)
sketchybar --add item space.X left \
           --set space.X icon="X" \
                         icon.font="SF Mono:Bold:14.0" \
                         icon.color=0xffcad3f5 \
                         label.drawing=off \
                         padding_left=0 \
                         padding_right=0 \
                         icon.padding_left=0 \
                         icon.padding_right=0 \
                         background.padding_left=5 \
                         background.padding_right=5 \
                         background.color=0xff363a4f \
                         background.corner_radius=6 \
                         background.height=26 \
                         background.border_width=2 \
                         background.border_color=0xff24273a \
                         background.drawing=on \
                         width=30 \
                         icon.width=30 \
                         icon.align=center \
                         drawing=off \
                         click_script="aerospace workspace X"

# Add update item that manages visibility
# Uses event-based updates via aerospace exec-on-workspace-change for instant response
sketchybar --add event aerospace_workspace_change \
           --add item aerospace_manager left \
           --set aerospace_manager update_freq=2 \
                                   script="$HOME/.config/sketchybar/plugins/aerospace.sh" \
                                   drawing=off \
           --subscribe aerospace_manager aerospace_workspace_change

# Right side - clock (far right) - colors match tmux (day=cyan, time=green/bold) with rounded background
sketchybar --add item clock right \
           --set clock update_freq=1 \
                       icon.font="FiraCode Nerd Font Mono:Regular:15.0" \
                       icon.color=0xff91d7e3 \
                       label.font="FiraCode Nerd Font Mono:Bold:13.0" \
                       label.color=0xffa6da95 \
                       icon.padding_left=8 \
                       icon.padding_right=4 \
                       label.padding_left=4 \
                       label.padding_right=8 \
                       background.color=0xff363a4f \
                       background.corner_radius=12 \
                       background.height=28 \
                       background.drawing=on \
                       padding_left=5 \
                       padding_right=5 \
                       script="$HOME/.config/sketchybar/plugins/clock.sh"

# Right side - battery with rounded background
sketchybar --add item battery right \
           --set battery update_freq=10 \
                         icon.font="FiraCode Nerd Font Mono:Regular:18.5" \
                         label.font="FiraCode Nerd Font Mono:Regular:13.0" \
                         icon.padding_left=8 \
                         icon.padding_right=4 \
                         icon.padding_bottom=4 \
                         label.padding_left=4 \
                         label.padding_right=8 \
                         background.color=0xff363a4f \
                         background.corner_radius=12 \
                         background.height=28 \
                         background.drawing=on \
                         padding_left=5 \
                         padding_right=5 \
                         script="$HOME/.config/sketchybar/plugins/battery.sh"

# Finalize
sketchybar --update

echo "sketchybar configuration loaded"
